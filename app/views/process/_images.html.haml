.inject-files.is-hidden-tablet.has-text-centered= render partial: 'add_files'
.inject-files.is-hidden-mobile(style="float: right")= render partial: 'add_files'

= form_with url: delete_archive_files_process_path(id: @info[:working_dir]),
  method: :delete, id: 'frm-images',
  data: { image_sel_mode: Setting[:process_img_sel] } do |f|
  = hidden_field_tag :tab, params[:tab]

  = action_buttons = capture do
    .has-text-centered.mb-4
      = f.button class: 'button is-rounded is-info mr-4', onclick: %Q|jQuery('.columns .column span.select-image').click(); return false| do
        %span.icon.is-small
          %i.mi select_all
        %span Toggle all images
      = f.button type: :submit, class: 'button is-rounded is-danger delete-images', data: { confirm: 'Delete 0 selected images?' } do
        %span.icon.is-small
          %i.mi delete
        %span Delete selected images

  - base_dir = File.join(Setting['dir.sorting'], @info[:working_dir], 'thumbs')
  - tab_idx = 0
  .columns.is-mobile.is-multiline
    - @info[:images].each do |img|
      .column.is-4-mobile.is-2-tablet.is-2-desktop.has-text-centered.nowrap<>
        = text_field_tag :img_name, img[:dst_path], id: '',
          class: 'update-name w100', tabindex: (1000 + tab_idx+=1),
          data: { url: rename_file_process_path, path: img[:src_path] }
        
        %span.button.is-small.select-image.is-hidden
          %span.icon.is-small
            %i.mi check_box_outline_blank
        
        = link_to show_image_process_path(id: @info[:working_dir], path: img[:src_path]), target: :_blank do
          %figure.image.is2by3.mt-1= thumbnail_tag File.join(base_dir, img[:thumb_path]),
            title: "#{img[:dst_path]} @ #{number_to_human_size img[:size]}\nâ†ª#{img[:src_path]}",
            decoding: :async
        
        = check_box_tag 'path[]', img[:src_path], false, id: '', class: 'is-hidden'
    - (6 - @info[:images].size % 6).times do
      .column.is-4-mobile.is-2-tablet.is-2-desktop<>

  = action_buttons
